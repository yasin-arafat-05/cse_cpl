<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Auction Teams | Cricket Auction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f9fafc;
            font-family: 'Poppins', sans-serif;
        }
        .card {
            border-radius: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .header {
            text-align: center;
            margin-top: 40px;
        }
        .header h2 {
            color: #0d6efd;
        }
        .back-btn {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2 id="tournament-name"></h2>
        <p class="text-muted">Teams participating in this tournament</p>
        <button class="btn btn-outline-secondary back-btn" onclick="goBack()">‚¨Ö Back to Tournaments</button>
    </div>

    <div id="team-list" class="row g-4 mt-4 justify-content-center">
        <!-- Teams will appear here -->
    </div>
</div>

<script>
async function loadTeams() {
    const params = new URLSearchParams(window.location.search);
    const tournamentName = params.get("tournament_name");
    const tournamentId = params.get("tournament_id");
    document.getElementById("tournament-name").innerText = `üèÜ ${tournamentName}`;

    try {
        const res = await fetch("http://127.0.0.1:8000/api/v1/admin/dashboard/teams/" + tournamentId+"/player-distribution");
        const teams = await res.json();
        const container = document.getElementById("team-list");
        container.innerHTML = "";

        if (teams.length === 0) {
            container.innerHTML = "<p class='text-center text-muted'>No teams available for this tournament.</p>";
            return;
        }

        teams.forEach(team => {
            const div = document.createElement("div");
            div.className = "col-md-4 col-sm-6";
            div.innerHTML = `
                <div class="card p-3 text-center">
                    <h5 class="fw-bold text-primary">${team.team_name}</h5>
                    <p><strong>Player Count:</strong> ${team.player_count}</p>
                    <p><strong>Max Players:</strong> ${team.max_players}</p>
                    <p><strong>Available Slots:</strong> ${team.available_slots}</p>
                    <button class="btn btn-outline-info mt-2" onclick="viewPlayers(${team.team_id}, '${team.team_name}', '${tournamentName}')">üëÄ View Players</button>
                </div>
            `;
            container.appendChild(div);
        });
    } catch (err) {
        console.error("Error fetching teams:", err);
    }
}

function goBack() {
    window.location.href = "/home/yasin/all_program/cpl/app/internal/html/tournament.html";
}

function viewPlayers(teamId, teamName, tournamentName) {
    alert(`üìã Showing players of ${teamName} under ${tournamentName}`);
}

loadTeams();
</script>

</body>
</html>
